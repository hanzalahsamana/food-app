<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
    integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-Piv4xVNRyMGpqkS2by6br4gNJ7DXjqk09RmUpJ8jgGtD7zP9yug3goQfGII0yAns"
    crossorigin="anonymous"></script>
    <title>Delivered orders</title>
    <meta content="" name="description">
    <meta content="" name="keywords">

    <!-- Favicons -->
    <link href="assets/img/favicon.png" rel="icon">
    <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
        rel="stylesheet">

    <!-- Vendor CSS Files -->
    <link href="assets/vendor/aos/aos.css" rel="stylesheet">
    <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
    <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
    <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- Template Main CSS File -->
    <link href="assets/css/style.css" rel="stylesheet">

    <!-- firbase CDN -->
    <script src="https://www.gstatic.com/firebasejs/8.9.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.9.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.9.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.9.1/firebase-storage.js"></script>

    <!-- =======================================================
        * Template Name: Day - v4.3.0
        * Template URL: https://bootstrapmade.com/day-multipurpose-html-template-for-free/
        * Author: BootstrapMade.com
        * License: https://bootstrapmade.com/license/
        ======================================================== -->
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light resturent-header">
        <h1 class="logo capitalize" id="rest-name-header"><a href="index.html"></a></h1>
        <button style="color: white !important;" class="navbar-toggler" type="button" data-toggle="collapse"
          data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false"
          aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="nav-col2 collapse navbar-collapse" id="navbarNavAltMarkup">
          <div class="navbar-nav">
            <a class="nav-link scrollto" href="./restaurent-dashboard.html">Home</a>
            <!-- <a class="nav-link scrollto" href="#about">Add Item</a> -->
            <a class="nav-link scrollto" href="./restaurant-pending-orders.html">Pending</a>
            <a class="nav-link scrollto" href="./restaurant-accepted-orders.html">Accept</a>
            <a class="nav-link scrollto active" href="./restaurant-delivered-orders.html">Delivered</a>
            <button class="btn btn-primary" onclick="return logout()">Log out</button>
          </div>
        </div>
      </nav>
   
    <!-- ======= Hero Section ======= -->
    <div>
        <section id="hero" class="d-flex align-items-center">
            <div class="container position-relative" style="opacity: inherit;" data-aos="fade-up" data-aos-delay="500">
                <h1>Track Orders</h1>
                <h2>Order your favourite burger on a very cheapest price.</h2>
                <a href="#about" class="btn-get-started scrollto">Get Started</a>
            </div>
        </section>
        <div class="restaurants">
            <div class="container">
                <h3>All Dishes</h3>
                <div class="row" id="restuarant-row">
                    <!-- <div class="col-lg-4 col-md-6 col-sm-12">
                        <div class="card" style="width: 18rem;">
                            <img class="card-img-top" src="assets/img/slider-image.jpg" alt="Card image cap">
                            <div class="card-body">
                                <h5 class="card-title">Sultan Fast Food</h5>
                                <p class="card-text">
                                    Give your hunger tasty a tasty treat, order now!
                                </p>
                            </div>

                            <div class="card-body">
                                <a href="#" class="card-link">Checkout Dishes</a>
                            </div>
                        </div>
                    </div> -->
                </div>
            </div>
        </div>
        <footer id="footer">
            <div class="footer-top">
                <div class="container">
                    <div class="row">

                        <div class="col-lg-4 col-md-6">
                            <div class="footer-info">
                                <h3>Foodie</h3>
                                <p>
                                    A108 Quaid Street <br>
                                    NY 535022, Pak<br><br>
                                    <strong>Phone:</strong> +1 5589 55488 55<br>
                                    <strong>Email:</strong> info@example.com<br>
                                </p>
                                <div class="social-links mt-3">
                                    <a href="#" class="twitter"><i class="bx bxl-twitter"></i></a>
                                    <a href="#" class="facebook"><i class="bx bxl-facebook"></i></a>
                                    <a href="#" class="instagram"><i class="bx bxl-instagram"></i></a>
                                    <a href="#" class="google-plus"><i class="bx bxl-skype"></i></a>
                                    <a href="#" class="linkedin"><i class="bx bxl-linkedin"></i></a>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-2 col-md-6 footer-links">
                            <h4>Useful Links</h4>
                            <ul>
                                <li><i class="bx bx-chevron-right"></i> <a href="#">Home</a></li>
                                <li><i class="bx bx-chevron-right"></i> <a href="#">About us</a></li>
                                <li><i class="bx bx-chevron-right"></i> <a href="#">Services</a></li>
                                <li><i class="bx bx-chevron-right"></i> <a href="#">Terms of service</a></li>
                                <li><i class="bx bx-chevron-right"></i> <a href="#">Privacy policy</a></li>
                            </ul>
                        </div>

                        <div class="col-lg-2 col-md-6 footer-links">
                            <h4>Our Services</h4>
                            <ul>
                                <li><i class="bx bx-chevron-right"></i> <a href="#">Food Delivery</a></li>
                                <li><i class="bx bx-chevron-right"></i> <a href="#">Gloceries Delivery</a></li>
                                <li><i class="bx bx-chevron-right"></i> <a href="#">Product Selling</a></li>
                                <li><i class="bx bx-chevron-right"></i> <a href="#">restaurants</a></li>
                                <li><i class="bx bx-chevron-right"></i> <a href="#">Fruits,Veg</a></li>
                            </ul>
                        </div>

                        <div class="col-lg-4 col-md-6 footer-newsletter">
                            <h4>Our Newsletter</h4>
                            <p>Tamen quem nulla quae legam multos aute sint culpa legam noster magna</p>
                            <form action="" method="post">
                                <input type="email" name="email"><input type="submit" value="Subscribe">
                            </form>

                        </div>

                    </div>
                </div>
            </div>

            <div class="container">
                <div class="copyright">
                    &copy; Copyright <strong><span>Day</span></strong>. All Rights Reserved
                </div>
                <div class="credits">
                    <!-- All the links in the footer should remain intact. -->
                    <!-- You can delete the links only if you purchased the pro version. -->
                    <!-- Licensing information: https://bootstrapmade.com/license/ -->
                    <!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/day-multipurpose-html-template-for-free/ -->
                    Designed by <a href="https://bootstrapmade.com/">BootstrapMade</a>
                </div>
            </div>
        </footer>

        <!-- End Hero -->
</body>

<script>
    // Your web app's Firebase configuration
    var firebaseConfig = {
        apiKey: "AIzaSyAmUNNZr54z9mB4SrsNCiE8eIKNDGC6dR4",
        authDomain: "foodie-ddbf9.firebaseapp.com",
        projectId: "foodie-ddbf9",
        storageBucket: "foodie-ddbf9.appspot.com",
        messagingSenderId: "353252623790",
        appId: "1:353252623790:web:a409d673e4f69d050c343f"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);

    var currentUserUID = ''
    var selectedRestaurant = {};
    function OnInit() {

        firebase.auth().onAuthStateChanged((user) => {
            if (user) {

                currentUserUID = user.uid;
                userName = user.displayName;


                userName = document.getElementById("rest-name-header").innerHTML = user.displayName
                getPendingOrders()

                console.log(userName)
                // ...
            } else {

                // User is signed out
                // ...
            }
        });


    }

    async function getPendingOrders(restaurantUID) {
        const events = await firebase.firestore().collection('orders').where("status", "==", "delivered").where("restaurantUID", "==", currentUserUID);
        events.onSnapshot((querySnapshot) => {
            const orders = []
            document.getElementById('restuarant-row').innerHTML = ''
            querySnapshot.forEach((doc) => {
                orders.push({ orderKey: doc.id, ...doc.data() })
            });
            // <div class="col-lg-4 col-md-6 col-sm-12">
            //             <div class="card" style="width: 18rem;">
            //                 <img class="card-img-top" src="assets/img/slider-image.jpg" alt="Card image cap">
            //                 <div class="card-body">
            //                     <h5 class="card-title">Sultan Fast Food</h5>
            //                     <p class="card-text">
            //                         Give your hunger tasty a tasty treat, order now!
            //                     </p>
            //                 </div>

            //                 <div class="card-body">
            //                     <a href="#" class="card-link">Checkout Dishes</a>
            //                 </div>
            //             </div>
            //         </div>

            //             <ul class="list-group list-group-flush">
            //     <li class="list-group-item">Cras justo odio</li>
            //     <li class="list-group-item">Dapibus ac facilisis in</li>
            //     <li class="list-group-item">Vestibulum at eros</li>
            //   </ul>
            orders.forEach((item, index) => {
                var col = document.createElement('div');
                col.setAttribute('class', 'col-lg-4 col-md-6 col-sm-12');

                var card = document.createElement('div');
                card.setAttribute('class', 'card capitalize');
                card.style.width = '18rem';
                col.appendChild(card);
                var img = document.createElement('img');
                img.setAttribute('class', 'card-img-top');
                img.setAttribute('src', item.image);
                img.setAttribute('alt', 'Card image cap');
                img.style.maxHeight = '12rem';
                img.style.objectFit = 'cover';

                card.appendChild(img);
                var cardBody = document.createElement('div');
                cardBody.setAttribute('class', 'card-body');
                var h5 = document.createElement('h5');
                h5.setAttribute('class', 'card-title');
                h5.innerHTML = item.itemName
                cardBody.appendChild(h5);
                var ul = document.createElement('ul');
                ul.setAttribute('class', 'list-group list-group-flush');
                var li1 = document.createElement('li');
                li1.setAttribute('class', 'list-group-item');
                li1.innerHTML = 'price: ' + item.price + ' RS';
                var li2 = document.createElement('li');
                li2.setAttribute('class', 'list-group-item');
                li2.innerHTML = 'delivery: ' + item.delivery;
                var li3 = document.createElement('li');
                li3.setAttribute('class', 'list-group-item');
                li3.innerHTML = 'category: ' + item.category;
                var li4 = document.createElement('li');
                li4.setAttribute('class', 'list-group-item');
                li4.innerHTML = 'status: ' + item.status;
                ul.appendChild(li1);
                ul.appendChild(li2)
                ul.appendChild(li3)
                ul.appendChild(li4)


                var para = document.createElement('p');
                para.setAttribute('class', 'card-text');
                para.innerHTML = 'Placed by: ' + item.orderPlacedByName
                cardBody.appendChild(para);
                card.appendChild(cardBody)
                var cardBody2 = document.createElement('div');
                cardBody2.setAttribute('class', 'card-body');
                var button = document.createElement('button');
                button.setAttribute('class', 'btn btn-outline-success')
                button.setAttribute('disabled', true)


                button.innerHTML = 'Delivered';

                cardBody2.appendChild(button)
                card.appendChild(ul);
                card.appendChild(cardBody2)
                document.getElementById('restuarant-row').appendChild(col)
            })
            console.log(orders)
        })
        //         firebase.firestore().collection("restaurent").doc().get().then((doc) => {
        //     if (doc.exists) {
        //         console.log("Document data:", doc.data());
        //     } else {
        //         // doc.data() will be undefined in this case
        //         console.log("No such document!");
        //     }
        // }).catch((error) => {
        //     console.log("Error getting document:", error);
        // });
    }
    function changeOrderStatus(order) {

        firebase.firestore().collection('orders').doc(order.orderKey).update({
            status: 'delivered'
        }).then(() => {
            alert('order marked as DELIVERED')
        }).catch(error => console.log(error))
    }
    function logout() {
        firebase.auth().signOut().then(() => {
            location.href = "./resturent-sign-up.html"
        }).catch((error) => {
            // An error happened.
            return false
        });

    }



    OnInit()

</script>

</html>